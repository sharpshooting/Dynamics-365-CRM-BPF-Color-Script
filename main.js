var activeProcessControlTheme =
{
    completeStage: {
        selected: {
            foreground: "#000000",
            background: "#f65314"
        },
        normal: {
            foreground: "#000000",
            background: "#ffbb00"
        }
    },
    incompleteStage: {
        selected: {
            foreground: "#000000",
            background: "#00a1f1"
        },
        normal: {
            foreground: "#000000",
            background: "#7cbb00"
        }
    },
    hover:
    {
        completeStage: {
            selected: {
                foreground: "#ffffff",
                background: "#852905"
            },
            normal: {
                foreground: "#ffffff",
                background: "#805e00"
            }
        },
        incompleteStage: {
            selected: {
                foreground: "#ffffff",
                background: "#004b70"
            },
            normal: {
                foreground: "#ffffff",
                background: "#293d00"
            }
        }
    } 
};

var abandonedProcessControlTheme =
{
    completeStage: {
        selected: {
            foreground: "#ffffff",
            background: "#000000"
        },
        normal: {
            foreground: "#ffffff",
            background: "#333333"
        }
    },
    incompleteStage: {
        selected: {
            foreground: "#000000",
            background: "#666666"
        },
        normal: {
            foreground: "#000000",
            background: "#999999"
        }
    },
    hover:
    {
        completeStage: {
            selected: {
                foreground: "#000000",
                background: "#00a1f1"
            },
            normal: {
                foreground: "#000000",
                background: "#00a1f1"
            }
        },
        incompleteStage: {
            selected: {
                foreground: "#000000",
                background: "#00a1f1"
            },
            normal: {
                foreground: "#000000",
                background: "#00a1f1"
            }
        }
    } 
};

var processControlOverrideStyle = document.createElement('style');
switch(Xrm.Page.context.client.getFormFactor())
{
    case 1:
        processControlOverrideStyle.innerHTML = `.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea span.stageNameContent{color:${activeProcessControlTheme.incompleteStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea div.stageIconHolder{color:${activeProcessControlTheme.incompleteStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea{background-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:after{border-left-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:before{border-top-color:${activeProcessControlTheme.incompleteStage.normal.background};border-bottom-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea span.stageNameContent{color:${activeProcessControlTheme.incompleteStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea div.stageIconHolder{color:${activeProcessControlTheme.incompleteStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea{background-color:${activeProcessControlTheme.incompleteStage.selected.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:after{border-left-color:${activeProcessControlTheme.incompleteStage.selected.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:before{border-top-color:${activeProcessControlTheme.incompleteStage.selected.background};border-bottom-color:${activeProcessControlTheme.incompleteStage.selected.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea span.stageNameContent{color:${activeProcessControlTheme.completeStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea div.stageIconHolder{color:${activeProcessControlTheme.completeStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea{background-color:${activeProcessControlTheme.completeStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:after{border-left-color:${activeProcessControlTheme.completeStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:before{border-top-color:${activeProcessControlTheme.completeStage.normal.background};border-bottom-color:${activeProcessControlTheme.completeStage.normal.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea span.stageNameContent{color:${activeProcessControlTheme.completeStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea div.stageIconHolder{color:${activeProcessControlTheme.completeStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea{background-color:${activeProcessControlTheme.completeStage.selected.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:after{border-left-color:${activeProcessControlTheme.completeStage.selected.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:before{border-top-color:${activeProcessControlTheme.completeStage.selected.background};border-bottom-color:${activeProcessControlTheme.completeStage.selected.background}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:hover span.stageNameContent{color:${activeProcessControlTheme.hover.incompleteStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:hover div.stageIconHolder{color:${activeProcessControlTheme.hover.incompleteStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:hover{background-color:${activeProcessControlTheme.hover.incompleteStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:hover:after{border-left-color:${activeProcessControlTheme.hover.incompleteStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage .processStageTailContainer div.stageContentArea:hover:before{border-top-color:${activeProcessControlTheme.hover.incompleteStage.normal.background};border-bottom-color:${activeProcessControlTheme.hover.incompleteStage.normal.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:hover span.stageNameContent{color:${activeProcessControlTheme.hover.incompleteStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:hover div.stageIconHolder{color:${activeProcessControlTheme.hover.incompleteStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:hover{background-color:${activeProcessControlTheme.hover.incompleteStage.selected.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:hover:after{border-left-color:${activeProcessControlTheme.hover.incompleteStage.selected.background}}.processControlContainer .processStageContainer.selectedStage .processStageTailContainer div.stageContentArea:hover:before{border-top-color:${activeProcessControlTheme.hover.incompleteStage.selected.background};border-bottom-color:${activeProcessControlTheme.hover.incompleteStage.selected.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:hover span.stageNameContent{color:${activeProcessControlTheme.hover.completeStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:hover div.stageIconHolder{color:${activeProcessControlTheme.hover.completeStage.normal.foreground}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:hover{background-color:${activeProcessControlTheme.hover.completeStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:hover:after{border-left-color:${activeProcessControlTheme.hover.completeStage.normal.background}}.processControlContainer .processStageContainer.unselectedStage.completedStage .processStageTailContainer div.stageContentArea:hover:before{border-top-color:${activeProcessControlTheme.hover.completeStage.normal.background};border-bottom-color:${activeProcessControlTheme.hover.completeStage.normal.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:hover span.stageNameContent{color:${activeProcessControlTheme.hover.completeStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:hover div.stageIconHolder{color:${activeProcessControlTheme.hover.completeStage.selected.foreground}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:hover{background-color:${activeProcessControlTheme.hover.completeStage.selected.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:hover:after{border-left-color:${activeProcessControlTheme.hover.completeStage.selected.background}}.processControlContainer .processStageContainer.selectedStage.completedStage .processStageTailContainer div.stageContentArea:hover:before{border-top-color:${activeProcessControlTheme.hover.completeStage.selected.background};border-bottom-color:${activeProcessControlTheme.hover.completeStage.selected.background}}`
        +
        `.processControlContainer .processStageContainer.completedStage:focus .processStageTailContainer div.stageContentArea .stageContent span.stageNameContent {color:${activeProcessControlTheme.completeStage.selected.foreground}}.processControlContainer .processStageContainer.completedStage:focus .processStageTailContainer:hover div.stageContentArea .stageContent span.stageNameContent {color:${activeProcessControlTheme.hover.completeStage.selected.foreground}}`
        +
        "div.stageLabelMask { display: hidden !important }";
        break;
    case 2:
    case 3:
        processControlOverrideStyle.innerHTML = `.processHeaderContainer .processStageContainer.unselectedStage{background-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage .afterProcessStage{border-left-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage .beforeProcessStage{border-top-color:${activeProcessControlTheme.incompleteStage.normal.background};border-bottom-color:${activeProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage .processStageName{color${activeProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage .stageIconHolder span{color:${activeProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage .stageTracker span{color:${activeProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.selectedStage{background-color:${activeProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage .afterProcessStage{border-left-color: ${activeProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage .beforeProcessStage{border-top-color:${activeProcessControlTheme.incompleteStage.selected.background};border-bottom-color:${activeProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage .processStageName{color:${activeProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage .stageIconHolder span{color:${activeProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage .stageTracker span{color:${activeProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage{background-color:${activeProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage .afterProcessStage{border-left-color:${activeProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage .beforeProcessStage{border-top-color:${activeProcessControlTheme.completeStage.normal.background};border-bottom-color:${activeProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage .processStageName{color:${activeProcessControlTheme.completeStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage .stageIconHolder span{color:${activeProcessControlTheme.completeStage.normal.foreground}}.processHeaderContainer .processStageContainer.selectedStage.completedStage{background-color:${activeProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage .afterProcessStage{border-left-color:${activeProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage .beforeProcessStage{border-top-color:${activeProcessControlTheme.completeStage.selected.background};border-bottom-color:${activeProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage .processStageName{color:${activeProcessControlTheme.completeStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage.completedStage .stageIconHolder span{color:${activeProcessControlTheme.completeStage.selected.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage{background-color:${abandonedProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage .afterProcessStage{border-left-color:${abandonedProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage .beforeProcessStage{border-top-color:${abandonedProcessControlTheme.incompleteStage.normal.background};border-bottom-color:${abandonedProcessControlTheme.incompleteStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage .processStageName{color:${abandonedProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage .stageIconHolder span{color:${abandonedProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.abortedStage .stageTracker span{color:${abandonedProcessControlTheme.incompleteStage.normal.foreground}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage{background-color:${abandonedProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage .afterProcessStage{border-left-color:${abandonedProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage .beforeProcessStage{border-top-color:${abandonedProcessControlTheme.incompleteStage.selected.background};border-bottom-color:${abandonedProcessControlTheme.incompleteStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage .processStageName{color:${abandonedProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage .stageIconHolder span{color:${abandonedProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage.abortedStage .stageTracker span{color:${abandonedProcessControlTheme.incompleteStage.selected.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage{background-color:${abandonedProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage .afterProcessStage{border-left-color:${abandonedProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage .beforeProcessStage{border-top-color:${abandonedProcessControlTheme.completeStage.normal.background};border-bottom-color:${abandonedProcessControlTheme.completeStage.normal.background}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage .processStageName{color:${abandonedProcessControlTheme.completeStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage .stageIconHolder span{color:${abandonedProcessControlTheme.completeStage.normal.foreground}}.processHeaderContainer .processStageContainer.unselectedStage.completedStage.abortedStage .stageTracker span{color:${abandonedProcessControlTheme.completeStage.normal.foreground}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage{background-color:${abandonedProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage .afterProcessStage{border-left-color:${abandonedProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage .beforeProcessStage{border-top-color:${abandonedProcessControlTheme.completeStage.selected.background};border-bottom-color:${abandonedProcessControlTheme.completeStage.selected.background}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage .processStageName{color:${abandonedProcessControlTheme.completeStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage .stageIconHolder span{color:${abandonedProcessControlTheme.completeStage.selected.foreground}}.processHeaderContainer .processStageContainer.selectedStage.completedStage.abortedStage .stageTracker span{color:${abandonedProcessControlTheme.completeStage.selected.foreground}}`;
        break;
    default:
        processControlOverrideStyle.innerHTML = "";
}

document.body.appendChild(processControlOverrideStyle);

/*
        `.processControlContainer .processStageContainer.unselectedStage div.stageLabelMask{background:${ToRGBA(processControlTheme.incompleteStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.normal.background)},${processControlTheme.incompleteStage.normal.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.incompleteStage.normal.background)}),color-stop(${processControlTheme.incompleteStage.normal.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.normal.background)},${processControlTheme.incompleteStage.normal.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.normal.background)},${processControlTheme.incompleteStage.normal.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.normal.background)},${processControlTheme.incompleteStage.normal.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.incompleteStage.normal.background)}',endColorstr='${ToHexARGB_100(processControlTheme.incompleteStage.normal.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.normal.background)},${processControlTheme.incompleteStage.normal.background})}.processControlContainer .processStageContainer.selectedStage div.stageLabelMask{background:${ToRGBA(processControlTheme.incompleteStage.selected.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.selected.background)},${processControlTheme.incompleteStage.selected.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.incompleteStage.selected.background)}),color-stop(${processControlTheme.incompleteStage.selected.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.selected.background)},${processControlTheme.incompleteStage.selected.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.selected.background)},${processControlTheme.incompleteStage.selected.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.selected.background)},${processControlTheme.incompleteStage.selected.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.incompleteStage.selected.background)}',endColorstr='${ToHexARGB_100(processControlTheme.incompleteStage.selected.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.incompleteStage.selected.background)},${processControlTheme.incompleteStage.selected.background})}.processControlContainer .processStageContainer.unselectedStage.completedStage div.stageLabelMask{background:${ToRGBA(processControlTheme.completeStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.normal.background)},${processControlTheme.completeStage.normal.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.completeStage.normal.background)}),color-stop(${processControlTheme.completeStage.normal.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.normal.background)},${processControlTheme.completeStage.normal.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.normal.background)},${processControlTheme.completeStage.normal.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.normal.background)},${processControlTheme.completeStage.normal.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.completeStage.normal.background)}',endColorstr='${ToHexARGB_100(processControlTheme.completeStage.normal.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.completeStage.normal.background)},${processControlTheme.completeStage.normal.background})}.processControlContainer .processStageContainer.selectedStage.completedStage div.stageLabelMask{background:${ToRGBA(processControlTheme.completeStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.selected.background)},${processControlTheme.completeStage.selected.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.completeStage.selected.background)}),color-stop(${processControlTheme.completeStage.selected.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.selected.background)},${processControlTheme.completeStage.selected.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.selected.background)},${processControlTheme.completeStage.selected.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.completeStage.selected.background)},${processControlTheme.completeStage.selected.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.completeStage.selected.background)}',endColorstr='${ToHexARGB_100(processControlTheme.completeStage.selected.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.completeStage.selected.background)},${processControlTheme.completeStage.selected.background})}`
        +
        `.processControlContainer .processStageContainer.unselectedStage:hover div.stageLabelMask{background:${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)},${processControlTheme.hover.incompleteStage.normal.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)}),color-stop(${processControlTheme.hover.incompleteStage.normal.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)},${processControlTheme.hover.incompleteStage.normal.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)},${processControlTheme.hover.incompleteStage.normal.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)},${processControlTheme.hover.incompleteStage.normal.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.hover.incompleteStage.normal.background)}',endColorstr='${ToHexARGB_100(processControlTheme.hover.incompleteStage.normal.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.normal.background)},${processControlTheme.hover.incompleteStage.normal.background})}.processControlContainer .processStageContainer.selectedStage:hover div.stageLabelMask{background:${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)},${processControlTheme.hover.incompleteStage.selected.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)}),color-stop(${processControlTheme.hover.incompleteStage.selected.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)},${processControlTheme.hover.incompleteStage.selected.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)},${processControlTheme.hover.incompleteStage.selected.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)},${processControlTheme.hover.incompleteStage.selected.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.hover.incompleteStage.selected.background)}',endColorstr='${ToHexARGB_100(processControlTheme.hover.incompleteStage.selected.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.hover.incompleteStage.selected.background)},${processControlTheme.hover.incompleteStage.selected.background})}.processControlContainer .processStageContainer.unselectedStage.completedStage:hover div.stageLabelMask{background:${ToRGBA(processControlTheme.hover.completeStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.normal.background)},${processControlTheme.hover.completeStage.normal.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.hover.completeStage.normal.background)}),color-stop(${processControlTheme.hover.completeStage.normal.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.normal.background)},${processControlTheme.hover.completeStage.normal.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.normal.background)},${processControlTheme.hover.completeStage.normal.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.normal.background)},${processControlTheme.hover.completeStage.normal.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.hover.completeStage.normal.background)}',endColorstr='${ToHexARGB_100(processControlTheme.hover.completeStage.normal.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.normal.background)},${processControlTheme.hover.completeStage.normal.background})}.processControlContainer .processStageContainer.selectedStage.completedStage:hover div.stageLabelMask{background:${ToRGBA(processControlTheme.hover.completeStage.normal.background)};background:-moz-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.selected.background)},${processControlTheme.hover.completeStage.selected.background});background:-webkit-gradient(linear,left,right,color-stop(${ToRGBA(processControlTheme.hover.completeStage.selected.background)}),color-stop(${processControlTheme.hover.completeStage.selected.background}));background:-webkit-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.selected.background)},${processControlTheme.hover.completeStage.selected.background});background:-o-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.selected.background)},${processControlTheme.hover.completeStage.selected.background});background:-ms-linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.selected.background)},${processControlTheme.hover.completeStage.selected.background});filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='${ToHexARGB_15(processControlTheme.hover.completeStage.selected.background)}',endColorstr='${ToHexARGB_100(processControlTheme.hover.completeStage.selected.background)}',GradientType=1);background:linear-gradient(left,${ToRGBA(processControlTheme.hover.completeStage.selected.background)},${processControlTheme.hover.completeStage.selected.background})}`
        +
        `.processControlContainer .processStageContainer.unselectedStage:hover div.stageLabelMask,
        .processControlContainer .processStageContainer.unselectedStage:focus div.stageLabelMask
        .processControlContainer .processStageContainer.selectedStage:hover div.stageLabelMask,
        .processControlContainer .processStageContainer.selectedStage:focus div.stageLabelMask
        {
            background-color: transparent;
}`*/

function ToRGBA(hex)
{
    hex = hex.replace('#','');
    r = parseInt(hex.substring(1,3), 16);
    g = parseInt(hex.substring(3,5), 16);
    b = parseInt(hex.substring(5,7), 16);

    result = 'rgba('+r+','+g+','+b+',0.15)';
    return result;
}

function ToHexARGB_15(hex)
{
    return '#26'+hex.substring(1, 3);
}

function ToHexARGB_100(hex)
{
    return '#FF'+hex.substring(1, 3);
}